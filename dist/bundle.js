({903:function(){var t=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,s){function i(t){try{u(o.next(t))}catch(t){s(t)}}function a(t){try{u(o.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,a)}u((o=o.apply(t,e||[])).next())}))};const e=/[A-Z]{3}[A-Z]* \d+[A-Z]? - .+/g,n=/(?:(?<sectionType>[A-Z][a-z]+)\n)?(?<weekdays>(?:[A-Z][a-z])+)\s+(?<startTime>\d\d?:\d\d(?:AM|PM))\s+-\s+(?<endTime>\d\d?:\d\d(?:AM|PM))\n(?<location>.+)\n(?<professors>\D+)(?<dtstart>[\d/]+)\s+-\s+(?<dtend>[\d/]+)/g,o=/(?<hours>\d+)(?::)(?<minutes>\d+)(?<isAfterNoon>PM)?/,r=/(^\s+)/gm,s=/(\s+$)/gm;class i extends Error{constructor(t){super(t),Object.setPrototypeOf(this,i.prototype)}}function a(t,e,n,o,r,s,i,a,l){let c=n.match(/../g).toString(),d=u(a,o);!function(t,e){for(e=e.toLowerCase();!e.includes(t.toUTCString().slice(0,2).toLowerCase());)t.setUTCDate(t.getUTCDate()+1)}(d,c);let T=u(a,r);T.setUTCDate(d.getUTCDate());let f=u(l,r);return f.setUTCHours(0,0,0,0),{summary:`${t} (${e})`,dtstart:d,dtend:T,location:s,description:"Professors: "+i.replace(/\n/gm," "),exclude:[],rrule:{freq:"WEEKLY",byDay:c,until:f}}}function u(t,e){let n=o.exec(e).groups;if(!n)throw new i("TIMEINFO ERROR");let r=new Date(t),s=parseInt(n.hours),a=0;return n.isAfterNoon&&s<12?a=12:n.isAfterNoon||12!=s||(a=-12),r.setUTCHours(s+a),r.setUTCMinutes(parseInt(n.minutes)),r}function l(t,e){let n=t.dtstart.getUTCHours(),o=t.dtstart.getUTCMinutes(),r=[];for(let s of e){if(!t.rrule.byDay.toLowerCase().includes(s.toUTCString().slice(0,2).toLowerCase()))continue;let e=new Date(s.getTime());e.setUTCHours(n),e.setUTCMinutes(o),r.push(e)}t.exclude=r}function c(t){return t.replace(r,"").replace(s,"").replace(/\n+/gm,"\n")}function d(t,e){let n,o=[];for(;null!==(n=e.exec(t));)o.push(n);return o}window.convertToIcal=function(o,r,s){return t(this,void 0,void 0,(function*(){if(!(o=o.trim()))throw new i("You inputted an empty schedule.");let u=function(t){const o=(t=c(t)).match(e);if(!o)throw new i("Couldn't find any class sections in your schedule. Please, check your schedule or contact my author.");const r=t.split(e);r.shift();let s=[];for(let t=0;t<o.length;t++){let e=r[t];if(e.includes("Dropped")||e.includes("Withdrawn"))continue;let i,u=d(e,n),l="";for(let e of u){let n=e.groups;(i=n.sectionType)&&(l=i),s.push(a(o[t],l,n.weekdays,n.startTime,n.endTime,n.location,n.professors,n.dtstart,n.dtend))}}return s}(o);if(!u)throw new i("Couldn't find any class sections in your schedule. Please, check your schedule or contact my author.");let f,D=u[0].dtstart,h=D.getUTCFullYear(),m=function(t){let e=t.getUTCMonth();return 7<=e&&e<=9?"Fall":0<=e&&e<=2?"Spring":"Summer"}(D);f=r?yield function(e,n){return t(this,void 0,void 0,(function*(){const t=`https://calendar.ucf.edu/${e}/${n}/no-classes/`;let o,r;try{o=yield fetch(t),r=(new DOMParser).parseFromString(yield o.text(),"text/html")}catch(t){throw new i("Couldn't connect to calendar.ucf.edu to get no-school events. Either check your internet connection and try again or uncheck 'I am a UCF student' tickbox.")}let s,a,u,l,c,d,T=r.querySelectorAll("tr.vevent"),f=[];for(let t of T){s=a=u=l=c=d=null;for(let e of t.querySelectorAll("abbr"))e.className.includes("dtstart")?u=e.title:e.className.includes("dtend")&&(l=e.title);if(d=t.querySelector("span.summary").textContent,!u||!d)continue;s=new Date(u);let e=t.querySelector("div.more-details");e&&(c=e.textContent.trim()),l?a=new Date(l):(a=new Date(s.getTime()),a.setUTCDate(a.getUTCDate()+1)),f.push({summary:d,dtstart:s,dtend:a,description:c||""})}return f}))}(h,m):[];let E=function(t){let e=[];for(let n of t){let t=(n.dtend.getTime()-n.dtstart.getTime())/864e5;if(t>1)for(let o=0;o<t+1;o++){let t=new Date(n.dtstart);t.setUTCDate(t.getUTCDate()+o),e.push(t)}else e.push(n.dtstart)}return console.log(e.map((t=>t.toUTCString()))),e}(f);for(let t of u)l(t,E);return function(t,e,n,o){let r=new T(e),s=`;TZID=${e}`,i=r.toDatetime(new Date)+"Z",a=`\n    BEGIN:VCALENDAR\n    SUMMARY:${t}\n    PRODID:-//Ovsyanka83//UnischedulerTS MIMEDIR//EN\n    VERSION:2.0\n    DTSTAMP:${i}\n    CREATED:${i}\n    LAST-MODIFIED:${i}\n    `;for(let t of n)a+=`\n        BEGIN:VEVENT\n        SUMMARY:${t.summary}\n        DESCRIPTION:${t.description}\n        LOCATION:${t.location}\n        DTSTART;VALUE=DATE-TIME${s}:${r.toDatetime(t.dtstart)}\n        DTEND;VALUE=DATE-TIME${s}:${r.toDatetime(t.dtend)}\n        RRULE:FREQ=WEEKLY;BYDAY=${t.rrule.byDay};INTERVAL=1;UNTIL=${r.toDatetime(t.rrule.until)}Z\n        EXDATE:${r.toExdateList(t.exclude)}\n        END:VEVENT\n        `;for(let t of o)a+=`\n        BEGIN:VEVENT\n        SUMMARY:${t.summary}\n        DESCRIPTION:${t.description}\n        DTSTART;VALUE=DATE${s}:${r.toDate(t.dtstart)}\n        DTEND;VALUE=DATE${s}:${r.toDate(t.dtend)}\n        END:VEVENT\n        `;return a+="\nEND:VCALENDAR",r.normalize(a)}(`Classes ${m} ${h}`,s,u,f)}))};class T{constructor(t){this.timezone=t}toDatetime(t){return`${this.toDate(t)}T${this.toTime(t)}`}toDate(t){return t.getUTCFullYear()+f(t.getUTCMonth()+1)+f(t.getUTCDate())}toTime(t){return f(t.getUTCHours())+f(t.getUTCMinutes())+f(t.getUTCSeconds())}toExdateList(t){return t.map(this.toDatetime,this).join(",")}normalize(t){return null===(e=c(t).match(/[^\r\n]+/g))||void 0===e?void 0:e.map(D).join("\r\n");var e}}function f(t){return t<10?"0"+t:""+t}function D(t){const e=[];let n=75;for(;t.length>n;)e.push(t.slice(0,n)),t=t.slice(n),n=74;return e.push(t),e.join("\r\n ")}}})[903]();
//# sourceMappingURL=bundle.js.map