({903:function(){var t=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,s){function i(t){try{a(o.next(t))}catch(t){s(t)}}function u(t){try{a(o.throw(t))}catch(t){s(t)}}function a(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,u)}a((o=o.apply(t,e||[])).next())}))};const e=/[A-Z]{3}[A-Z]* \d+[A-Z]? - .+/g,n=/(?:(?<sectionType>[A-Z][a-z]+)\n)?(?<weekdays>(?:[A-Z][a-z])+)\s+(?<startTime>\d\d?:\d\d(?:AM|PM))\s+-\s+(?<endTime>\d\d?:\d\d(?:AM|PM))\n(?<location>.+)\n(?<professors>\D+)(?<dtstart>[\d/]+)\s+-\s+(?<dtend>[\d/]+)/g,o=/(^\s+)/gm,r=/(\s+$)/gm,s=/\n+/gm,i=/(?<hours>\d+)(?::)(?<minutes>\d+)(?<isAfterNoon>PM)?/,u="America/New_York";class a extends Error{constructor(t){super(t),Object.setPrototypeOf(this,a.prototype)}}function l(t,e,n,o,r,s,i,a,l){let d=n.match(/../g).toString(),f=c(a,o);!function(t,e){for(e=e.toLowerCase();!e.includes(t.toUTCString().slice(0,2).toLowerCase());)t.setUTCDate(t.getUTCDate()+1)}(f,d);let T=c(a,r);T.setUTCDate(f.getUTCDate());let m=c(l,r);return m.setUTCHours(0,0,0,0),{summary:`${t} (${e})`,start:f,end:T,location:s,description:"Professors: "+i.replace(/\n/gm," "),timezone:u,rrule:{freq:"WEEKLY",byDay:d,until:m}}}function c(t,e){let n=i.exec(e).groups;if(!n)throw new a("TIMEINFO ERROR");let o=new Date(t),r=parseInt(n.hours),s=0;return n.isAfterNoon&&r<12?s=12:n.isAfterNoon||12!=r||(s=-12),o.setUTCHours(r+s),o.setUTCMinutes(parseInt(n.minutes)),o}function d(t,e){let n=t.start.getUTCHours(),o=t.start.getUTCMinutes(),r=[];for(let s of e){if(!t.rrule.byDay.toLowerCase().includes(s.toUTCString().slice(0,2).toLowerCase()))continue;let e=new Date(s.getTime());e.setUTCHours(n),e.setUTCMinutes(o),r.push(e)}t.rrule.exclude=r}function f(t){return t.replace(o,"").replace(r,"").replace(s,"\n")}function T(t,e){let n,o=[];for(;null!==(n=e.exec(t));)o.push(n);return o}window.convertToIcal=function(o,r){return t(this,void 0,void 0,(function*(){if(!(o=o.trim()))throw new a("You inputted an empty schedule.");let s=function(t){const o=(t=f(t)).match(e);if(!o)throw new a("Couldn't find any class sections in your schedule. Please, check your schedule or contact my author.");const r=t.split(e);r.shift();let s=[];for(let t=0;t<o.length;t++){let e=r[t];if(e.includes("Dropped")||e.includes("Withdrawn"))continue;let i,u=T(e,n),a="";for(let e of u){let n=e.groups;(i=n.sectionType)&&(a=i),s.push(l(o[t],a,n.weekdays,n.startTime,n.endTime,n.location,n.professors,n.dtstart,n.dtend))}}return s}(o);if(!s)throw new a("Couldn't find any class sections in your schedule. Please, check your schedule or contact my author.");let i,c=s[0].start,h=c.getUTCFullYear(),D=function(t){let e=t.getUTCMonth();return 7<=e&&e<=9?"Fall":0<=e&&e<=2?"Spring":"Summer"}(c);i=r?yield function(e,n){return t(this,void 0,void 0,(function*(){const t=`https://calendar.ucf.edu/${e}/${n}/no-classes/`;let o,r;try{o=yield fetch(t),r=(new DOMParser).parseFromString(yield o.text(),"text/html")}catch(t){throw new a("Couldn't connect to calendar.ucf.edu to get no-school events. Either check your internet connection and try again or uncheck 'I am a UCF student' tickbox.")}let s,i,l,c,d,f,T=r.querySelectorAll("tr.vevent"),m=[];for(let t of T){s=i=l=c=d=f=null;for(let e of t.querySelectorAll("abbr"))e.className.includes("dtstart")?l=e.title:e.className.includes("dtend")&&(c=e.title);if(f=t.querySelector("span.summary").textContent,!l||!f)continue;s=new Date(l);let e=t.querySelector("div.more-details");e&&(d=e.textContent.trim()),c?i=new Date(c):(i=new Date(s.getTime()),i.setUTCDate(i.getUTCDate()+1)),m.push({summary:f,start:s,end:i,description:d||"",timezone:u})}return m}))}(h,D):[];let E=function(t){let e=[];for(let n of t){let t=(n.end.getTime()-n.start.getTime())/864e5;if(t>1)for(let o=0;o<t+1;o++){let t=new Date(n.start);t.setUTCDate(t.getUTCDate()+o),e.push(t)}else e.push(n.start)}return console.log(e.map((t=>t.toUTCString()))),e}(i);for(let t of s)d(t,E);return function(t,e,n,o){let r=`BEGIN:VCALENDAR\nSUMMARY:${t}\nTIMEZONE:${e}\n`,s=new m(e);for(let t of n)r+=`\n        BEGIN:VEVENT\n        SUMMARY:${t.summary}\n        DESCRIPTION:${t.description}\n        LOCATION:${t.location}\n        DTSTART;VALUE=DATE-TIME:${s.toDatetime(t.start)}\n        DTEND;VALUE=DATE-TIME:${s.toDatetime(t.end)}\n        RRULE:FREQ=WEEKLY;BYDAY=${t.rrule.byDay};INTERVAL=1;UNTIL=${s.toDatetime(t.rrule.until)}\n        EXDATE:${s.toExdateList(t.rrule.exclude)}\n        END:VEVENT\n        `;for(let t of o)r+=`\n        BEGIN:VEVENT\n        SUMMARY:${t.summary}\n        DESCRIPTION:${t.description}\n        DTSTART;VALUE=DATE:${s.toDate(t.start)}\n        DTEND;VALUE=DATE:${s.toDate(t.end)}\n        END:VEVENT\n        `;return r+="\nEND:VCALENDAR",s.normalize(r)}(`Classes ${D} ${h}`,u,s,i)}))};class m{constructor(t){this.timezone=t}toDatetime(t){return`${this.toDate(t)}T${this.toTime(t)}`}toDate(t){return t.getUTCFullYear()+h(t.getUTCMonth()+1)+h(t.getUTCDate())}toTime(t){return h(t.getUTCHours())+h(t.getUTCMinutes())+h(t.getUTCSeconds())}toExdateList(t){return t.map(this.toDatetime,this).join(",")}normalize(t){return null===(e=f(t).match(/[^\r\n]+/g))||void 0===e?void 0:e.map(D).join("\n");var e}}function h(t){return t<10?"0"+t:""+t}function D(t){const e=[];let n=75;for(;t.length>n;)e.push(t.slice(0,n)),t=t.slice(n),n=74;return e.push(t),e.join("\n ")}}})[903]();
//# sourceMappingURL=bundle.js.map