({903:function(){var t=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,s){function i(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,a)}u((r=r.apply(t,e||[])).next())}))};const e=/[A-Z]{3}[A-Z]* \d+[A-Z]? - .+/g,n=/(?:(?<sectionType>[A-Z][a-z]+)\n)?(?<weekdays>(?:[A-Z][a-z])+)\s+(?<startTime>\d\d?:\d\d(?:AM|PM))\s+-\s+(?<endTime>\d\d?:\d\d(?:AM|PM))\n(?<location>.+)\n(?<professors>\D+)(?<dtstart>[\d/]+)\s+-\s+(?<dtend>[\d/]+)/g,r=/(^\s+)/gm,o=/(\s+$)/gm,s=/\n+/gm,i=/(?<hours>\d+)(?::)(?<minutes>\d+)(?<isAfterNoon>PM)?/;class a extends Error{constructor(t){super(t),Object.setPrototypeOf(this,a.prototype)}}function u(t,e,n,r,o,s,i,a,u){let c=n.match(/../g).toString(),d=l(a,r);!function(t,e){for(e=e.toLowerCase();!e.includes(t.toUTCString().slice(0,2).toLowerCase());)t.setUTCDate(t.getUTCDate()+1)}(d,c);let T=l(a,o);T.setUTCDate(d.getUTCDate());let f=l(u,o);return f.setUTCHours(0,0,0,0),{summary:`${t} (${e})`,start:d,end:T,location:s,description:"Professors: "+i.replace(/\n/gm," "),rrule:{freq:"WEEKLY",byDay:c,until:f}}}function l(t,e){let n=i.exec(e).groups;if(!n)throw new a("TIMEINFO ERROR");let r=new Date(t),o=parseInt(n.hours),s=0;return n.isAfterNoon&&o<12?s=12:n.isAfterNoon||12!=o||(s=-12),r.setUTCHours(o+s),r.setUTCMinutes(parseInt(n.minutes)),r}function c(t,e){let n=t.start.getUTCHours(),r=t.start.getUTCMinutes(),o=[];for(let s of e){if(!t.rrule.byDay.toLowerCase().includes(s.toUTCString().slice(0,2).toLowerCase()))continue;let e=new Date(s.getTime());e.setUTCHours(n),e.setUTCMinutes(r),o.push(e)}t.rrule.exclude=o}function d(t){return t.replace(r,"").replace(o,"").replace(s,"\n")}function T(t,e){let n,r=[];for(;null!==(n=e.exec(t));)r.push(n);return r}window.convertToIcal=function(r,o,s){return t(this,void 0,void 0,(function*(){if(!(r=r.trim()))throw new a("You inputted an empty schedule.");let i=function(t){const r=(t=d(t)).match(e);if(!r)throw new a("Couldn't find any class sections in your schedule. Please, check your schedule or contact my author.");const o=t.split(e);o.shift();let s=[];for(let t=0;t<r.length;t++){let e=o[t];if(e.includes("Dropped")||e.includes("Withdrawn"))continue;let i,a=T(e,n),l="";for(let e of a){let n=e.groups;(i=n.sectionType)&&(l=i),s.push(u(r[t],l,n.weekdays,n.startTime,n.endTime,n.location,n.professors,n.dtstart,n.dtend))}}return s}(r);if(!i)throw new a("Couldn't find any class sections in your schedule. Please, check your schedule or contact my author.");let l,D=i[0].start,h=D.getUTCFullYear(),m=function(t){let e=t.getUTCMonth();return 7<=e&&e<=9?"Fall":0<=e&&e<=2?"Spring":"Summer"}(D);l=o?yield function(e,n){return t(this,void 0,void 0,(function*(){const t=`https://calendar.ucf.edu/${e}/${n}/no-classes/`;let r,o;try{r=yield fetch(t),o=(new DOMParser).parseFromString(yield r.text(),"text/html")}catch(t){throw new a("Couldn't connect to calendar.ucf.edu to get no-school events. Either check your internet connection and try again or uncheck 'I am a UCF student' tickbox.")}let s,i,u,l,c,d,T=o.querySelectorAll("tr.vevent"),f=[];for(let t of T){s=i=u=l=c=d=null;for(let e of t.querySelectorAll("abbr"))e.className.includes("dtstart")?u=e.title:e.className.includes("dtend")&&(l=e.title);if(d=t.querySelector("span.summary").textContent,!u||!d)continue;s=new Date(u);let e=t.querySelector("div.more-details");e&&(c=e.textContent.trim()),l?i=new Date(l):(i=new Date(s.getTime()),i.setUTCDate(i.getUTCDate()+1)),f.push({summary:d,start:s,end:i,description:c||""})}return f}))}(h,m):[];let E=function(t){let e=[];for(let n of t){let t=(n.end.getTime()-n.start.getTime())/864e5;if(t>1)for(let r=0;r<t+1;r++){let t=new Date(n.start);t.setUTCDate(t.getUTCDate()+r),e.push(t)}else e.push(n.start)}return console.log(e.map((t=>t.toUTCString()))),e}(l);for(let t of i)c(t,E);return function(t,e,n,r){let o=new f(e),s=`;TZID=${e}`,i=o.toDatetime(new Date)+"Z",a=`\n    BEGIN:VCALENDAR\n    SUMMARY:${t}\n    PRODID:-//Ovsyanka83//UnischedulerTS MIMEDIR//EN\n    VERSION:2.0\n    DTSTAMP:${i}\n    CREATED:${i}\n    LAST-MODIFIED:${i}\n    `;for(let t of n)a+=`\n        BEGIN:VEVENT\n        SUMMARY:${t.summary}\n        DESCRIPTION:${t.description}\n        LOCATION:${t.location}\n        DTSTART;VALUE=DATE-TIME${s}:${o.toDatetime(t.start)}\n        DTEND;VALUE=DATE-TIME${s}:${o.toDatetime(t.end)}\n        RRULE:FREQ=WEEKLY;BYDAY=${t.rrule.byDay};INTERVAL=1;UNTIL=${o.toDatetime(t.rrule.until)}Z\n        EXDATE:${o.toExdateList(t.rrule.exclude)}\n        END:VEVENT\n        `;for(let t of r)a+=`\n        BEGIN:VEVENT\n        SUMMARY:${t.summary}\n        DESCRIPTION:${t.description}\n        DTSTART;VALUE=DATE${s}:${o.toDate(t.start)}\n        DTEND;VALUE=DATE${s}:${o.toDate(t.end)}\n        END:VEVENT\n        `;return a+="\nEND:VCALENDAR",o.normalize(a)}(`Classes ${m} ${h}`,s,i,l)}))};class f{constructor(t){this.timezone=t}toDatetime(t){return`${this.toDate(t)}T${this.toTime(t)}`}toDate(t){return t.getUTCFullYear()+D(t.getUTCMonth()+1)+D(t.getUTCDate())}toTime(t){return D(t.getUTCHours())+D(t.getUTCMinutes())+D(t.getUTCSeconds())}toExdateList(t){return t.map(this.toDatetime,this).join(",")}normalize(t){return null===(e=d(t).match(/[^\r\n]+/g))||void 0===e?void 0:e.map(h).join("\r\n");var e}}function D(t){return t<10?"0"+t:""+t}function h(t){const e=[];let n=75;for(;t.length>n;)e.push(t.slice(0,n)),t=t.slice(n),n=74;return e.push(t),e.join("\r\n ")}}})[903]();
//# sourceMappingURL=bundle.js.map